<!DOCTYPE html>
<html lang="en">

<head>
	<title>U410 도시이야기 57호 원고 제출</title>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="images/icons/ms-icon-150x150.png" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css" />
	<link rel="stylesheet" type="text/css" href="css/main.css" />
	<!--===============================================================================================-->

	<!-- Filepond stylesheet -->
	<link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">
</head>

<body>
	<div class="bg-contact100" style="background-image: url('images/56_bg.png');">
		<div class="container-contact100">
			<div class="wrap-contact100">
				<!-- <div class="contact100-pic js-tilt" data-tilt>
					<img src="images/221_U410_logo_basic.svg" alt="IMG">
				</div> -->

				<form class="contact100-form validate-form"
					action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSfvDX9X32SUriV7-JVr5fLHEA1SXOXP-TYDkgzBvyYdAY8srw/formResponse"
					target="_self" method="POST" id="mG61Hd">
					<div class="logo-pic">
						<svg version="1.1" id="&#xB808;&#xC774;&#xC5B4;_1" xmlns="http://www.w3.org/2000/svg"
							xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 400 280.664"
							style="enable-background: new 0 0 400 280.664;" xml:space="preserve">
							<g>
								<g>
									<polygon
										points="147.109,105.092 168.911,90.895 192.106,97.258 188.485,75.622 119.001,97.381 		" />
									<path d="M201.606,154.025l-24.436-6.703l21.023-13.69l-6.034-36.053l-21.471,13.981l12.262,3.363l-20.162,13.129l-12.262-3.363
		l-16.557,10.782l-23.58-6.469l16.556-10.782l-54.895-15.06l20.162-13.129l93.769-29.363l-6.544-39.1c0,0-1.606-3.705-4.569-4.816
		c-2.964-1.111-5.187-0.864-7.039,0.124S62.366,80.6,62.366,80.6s-9.633,3.705-16.178,4.075c-6.545,0.37-10.62,0.494-17.659-0.371
		C21.49,83.44,17.785,80.23,17.785,80.23l94.596-57.672l16.796,4.446l-4.075-21.735c0,0-2.099-4.198-4.075-4.939
		c-1.976-0.741-6.669,0-6.669,0L7.659,64.669c0,0-3.582,1.976-5.31,5.187c-1.729,3.211-2.1,5.557-2.347,7.41
		c-0.247,1.852,29.392,181.288,29.392,181.288s1.852,7.657,4.446,9.88c2.593,2.223,9.385,7.287,15.683,9.139
		c6.298,1.852,21.611,3.582,28.897,2.964c7.287-0.618,19.266-3.829,25.07-7.657c5.804-3.828,100.03-60.759,100.03-60.759
		s4.322-2.344,5.434-6.174c1.111-3.829,0-8.028,0-8.028L201.606,154.025z" />
									<polygon points="245.025,57.917 218.238,50.569 185.982,60.669 188.485,75.622 		" />
									<polygon points="192.491,97.364 192.106,97.258 192.16,97.579 		" />
									<polygon points="201.884,154.101 318.598,78.1 293.884,71.321 245.876,77.266 222.927,92.21 270.935,86.265 198.194,133.632 
		201.606,154.025 		" />
									<path d="M399.699,107.782c-0.758-2.939-2.86-5.588-6.295-7.947c-3.441-2.359-7.861-4.281-13.268-5.764
		c-5.537-1.518-11.52-2.452-17.951-2.8c-6.437-0.349-13.016-0.081-19.74,0.804c-6.724,0.887-13.346,2.433-19.861,4.641
		c-6.518,2.207-12.562,5.124-18.136,8.754l-49.177,32.022c-5.573,3.63-9.42,7.152-11.534,10.566
		c-2.12,3.415-2.761,6.601-1.94,9.557c0.822,2.956,2.92,5.606,6.296,7.946c3.375,2.342,7.826,4.272,13.363,5.79
		c5.405,1.483,11.358,2.407,17.857,2.774c6.496,0.368,13.076,0.098,19.738-0.805c6.659-0.904,13.247-2.459,19.768-4.667
		c6.515-2.205,12.561-5.124,18.136-8.754l49.176-32.022c5.575-3.63,9.415-7.151,11.537-10.566
		C399.78,113.898,400.457,110.721,399.699,107.782z M361.091,121.313l-48.686,31.702c-4.917,3.203-10.26,5.301-16.029,6.297
		c-5.77,0.997-11.02,0.847-15.74-0.449c-4.726-1.297-7.218-3.269-7.475-5.919c-0.261-2.651,2.069-5.576,6.988-8.779l48.686-31.702
		c4.918-3.203,10.316-5.31,16.206-6.326c5.887-1.015,11.193-0.874,15.919,0.423c4.721,1.295,7.155,3.278,7.297,5.947
		C368.393,115.176,366.008,118.111,361.091,121.313z" />
								</g>
							</g>
						</svg>
					</div>
					<div class="contact100-form-div">
						<span class="contact100-form-title">
							도시이야기 56호 원고 제출
						</span>
					</div>

					<div class="wrap-input100 validate-input" data-validate="이메일 주소를 u410@yonsei.ac.kr와 같이 정확히 입력해주세요.">
						<input class="input100" type="email" id="emailAddress" name="emailAddress"
							placeholder="이메일 주소" />
						<span class="focus-input100"></span>
						<span class="symbol-input100">
							<i class="fa fa-envelope" aria-hidden="true"></i>
						</span>
					</div>

					<div class="wrap-input100 validate-input" data-validate="성명을 입력해주세요.">
						<input class="input100" type="text" name="entry.173697559" placeholder="성명" />
						<span class="focus-input100"></span>
						<span class="symbol-input100">
							<i class="fa fa-user" aria-hidden="true"></i>
						</span>
					</div>

					<div class="wrap-input100 validate-input" data-validate="동명이인 구분을 위해, 학번을 입력해주세요.">
						<input class="input100" type="number" name="entry.2054233807" placeholder="입학연도 마지막 2자리 (학번)"
							pattern="[0-9][0-9]" />
						<span class="focus-input100"></span>
						<span class="symbol-input100">
							<i class="fa fa-id-card" aria-hidden="true"></i>
						</span>
					</div>

					<div class="container-file">
						<div class="wrap-file">
							<!-- We'll transform this input into a pond -->
							<input type="file" name="filepond" class="filepond" server='server' data-max-file-size="3GB"
								required multiple>
						</div>
					</div>

					<div class="wrap-input100 validate-input" data-validate="후기를 입력해주세요.">
						<textarea class="input100" name="entry.1824972449" placeholder="57호 기고 후기"></textarea>
						<span class="focus-input100"></span>
					</div>

					<div class="wrap-input100">
						<input type="checkbox" name="entry.1472348045" value="동의" data-answer-value="동의" id="agree-term"
							class="agree-term" onchange="showAgreeTerm()" oninvalid="alert('개인정보 수집 및 이용에 동의 해주세요.')"
							required />
						<div class="limiter">
							<p class="agreeTerm">개인정보 수집·이용 등에 관한 안내</p>
							<p class="agreeTerm-content">U410 학회지 '도시이야기'에 등재될 글 모집을 위하여 아래와 같이 개인정보를 수집·이용 및 제공하고자 합니다.
								내용을 자세히 읽으신 후 동의 여부를 결정하여 주십시오.</p>
							<div class="wrap-table100">
								<div class="table">
									<div class="row header">
										<div class="cell">
											수집·이용 항목
										</div>
										<div class="cell">
											수집·이용 목적
										</div>
									</div>

									<div class="row">
										<div class="cell" data-title="수집·이용 항목">
											이름, 이메일 주소, 입학연도
										</div>
										<div class="cell" data-title="수집·이용 목적">
											학회지 글 등재
										</div>
									</div>
								</div>
							</div>
							<p class="agreeTerm-content">위의 개인정보 수집·이용 등에 관한 동의를
								거부할 수 있습니다. 다만, 동의하지 아니할 경우, 원활한 서비스 제공에 제한을 받을 수 있습니다.</p>
						</div>
						<label for="agree-term" class="check-box check-box-text">
							<span></span> 개인정보 수집 및 이용에 동의합니다.
							<ins><i>개인정보 수집 및 이용에 동의합니다.</i></ins></label>
					</div>

					<!-- for google form -->
					<input type="hidden" name="fvv" value="1" />
					<input type="hidden" name="pageHistory" value="0" />
					<input type="hidden" name="fbzx" value="9013002698688872533" />

					<div class="container-contact100-form-btn">
						<button type="submit" value="제출" class="contact100-form-btn" onclick="saveFile()">
							제출하기
						</button>
					</div>
				</form>
			</div>
		</div>
		<footer>
			<p>This templates was made by
				<a href="https://colorlib.com">Colorlib</a>.</p>
		</footer>
	</div>

	<!--===============================================================================================-->
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/tilt/tilt.jquery.min.js"></script>
	<script>
		$(".js-tilt").tilt({
			scale: 1.1,
		});
	</script>
	<!--===============================================================================================-->
	<script src="js/main.js"></script>
	<script src="js/saveFile.js"></script>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
	<script>
		window.dataLayer = window.dataLayer || [];

		function gtag() {
			dataLayer.push(arguments);
		}
		gtag("js", new Date());

		gtag("config", "UA-23581568-13");
	</script>

	<!-- FilePond -->
	<!-- Load FilePond library -->
	<script src="https://unpkg.com/filepond/dist/filepond.js"></script>

	<!-- Turn all file input elements into ponds -->
	<script>
		// get a reference to the input element
		const inputElement = document.querySelector('input[type="file"]');

		var baseUrl = 'https://urbanstory.blob.core.windows.net/manuscript/'
		var token = '?sv=2019-12-12&ss=b&srt=o&sp=rwdac&se=2020-08-19T19:40:32Z&st=2020-08-19T11:40:32Z&spr=https&sig=%2FqaUbf9g82QEJUJo7ZI9KSzmPa7NgPzqOzPuB6ejoKQ%3D';
		var processUri = '';

		var userId = document.getElementById('emailAddress').value;
		var indexOfIdEnd = userId.indexOf("@");
		userId = userId.substring(0, indexOfIdEnd);

		// create a FilePond instance at the input element location
		const pond = FilePond.create(inputElement, {
			name: 'filepond',
			onaddfile: (err, file) => {
				if (err) {
					console.log('ERROR: File add');
					return;
				}
				console.log(file.filename);
				// processUri = baseUrl.substring(0, indexOfQueryStart) + "manuscript/" + file.filename;
				processUri = baseUrl + file.filename + token;
				// processUri = baseUrl.substring(0, indexOfQueryStart) + "manuscript/" + userId + "/" + file.filename + baseUrl.substring(indexOfQueryStart);

				FilePond.setOptions({
					server: {
						// url: processUri,
						process: (fieldName, file, metadata, load, error, progress, abort, transfer,
							options) => {

							// fieldName is the name of the input field
							// file is the actual file object to send
							const formData = new FormData();
							formData.append(fieldName, file, file.name);

							const request = new XMLHttpRequest();
							request.open('PUT', processUri);
							request.setRequestHeader('x-ms-blob-type', 'BlockBlob');

							// Should call the progress method to update the progress to 100% before calling load
							// Setting computable to false switches the loading indicator to infinite mode
							request.upload.onprogress = (e) => {
								progress(e.lengthComputable, e.loaded, e.total);
							};

							// Should call the load method when done and pass the returned server file id
							// this server file id is then used later on when reverting or restoring a file
							// so your server knows which file to return without exposing that info to the client
							request.onload = function () {
								if (request.status >= 200 && request.status < 300) {
									// the load method accepts either a string (id) or an object
									load(request.responseText);
								} else {
									// Can call the error method if something is wrong, should exit after
									error('oh no');
								}
							};

							request.send(formData);

							// Should expose an abort method so the request can be cancelled
							return {
								abort: () => {
									// This function is entered if the user has tapped the cancel button
									request.abort();

									// Let FilePond know the request has been cancelled
									abort();
								}
							};
						},

						// process: {
						// 	method: 'PUT',
						// 	headers: {
						// 		// 	// 'Authorization': 'Shared access signature: BK25ZQbOCh2Y4%2FM%2FzTn2ERXBwkKPMCtvrCiAHD%2F6aZM%3D',
						// 		// 	'x-ms-date': (new Date()).toUTCString(),
						// 		// 	'x-ms-version': '2019-12-12',
						// 		// 	// 'Content-Length': 0,
						// 		'x-ms-blob-type': 'BlockBlob',
						// 		'Content-Type': 'text/plain'
						// 	},
						// 	// withCredentials: false,
						// 	// onerror: (response) => console.log(response.data)
						// },
						// fetch: null,
						// revert: null
					}
				});
			}
		});
	</script>

</body>

</html>